# timer.muzin.space

## Форк https://valerykoretsky.com/blog/countdown-php-js/

Поскольку [Музин](https://vk.com/id167109807) покинул нашу беседу раз и навсегда (но это, конечно же, не факт), то и таймер на данный момент для него нам не требуется.

## Настройка
1. Залейте на VPS/VDS/Dedicated/Hosting, настройте Apache/Nginx...
2. Зайдите в админ-панель по адресу yourdomain/timer/admin.php и зарегистрируйте админ пользователя.

   К сожалению, админ-пользователь может быть только один. Так уж решил создатель оригинального таймера. Честно говоря, мне лень это переделывать.
3. Радуйтесь жизни : )

## Админ-панель
Админ-панель доступна по адресу yourdomain/timer/admin.php. В принципе, это всё, что о ней можно рассказать. Она интуитивно понятна и не требует объяснений.

## Что добавлено в форк
1. Собственно, главная страница. Пущай она хоть и убогая, но хотя бы что-то, чем ничего.
2. Кол-во штрафов в часах.

# Более подробная документация
## 1. Описание
### 1.1. Общая информация
**SD Timer (timer.muzin.space)** - это многофункциональный бесплатный таймер/счетчик обратного отсчета. Скрипт предназначен для создания на своем сайте таймера, цели установки бывают разными, это и необходимость наглядно сообщить пользователю об открытии своего проекта, проведение акций, чтобы сообщить о лимите времени. Серверная часть написана на PHP, база данных внутренняя, поэтому он может быть установлен практически на любом существующем хостинге в мире, клиентская часть имеет стандартный набор JavaScript/jQuery,HTML,CSS.

### 1.2. Возможности
- выбор типа таймер (отсчет к указанной дате, отсчет указанного времени и специальный тип);
- поддержка cookie и IP-пользователя;
- настройка разных страниц при активном и неактивном таймере;
- настройка редирект по завершению таймера;
- настройка шаблонов;
- выбор языка для подписей;
- настройка отображаемых блоков (недели, дни, часы, минуты, секунды);
- добавление неограниченного числа счетчиков на страницу.

## Структура скрипта
### 2.1. Структура директорий и файлов
_timer/static_ - статические файлы скрипта, таблицы стилей, скрипты, изображения;  
_timer/themes_ - шаблоны таймера;  
_timer/tools_ - системные файлы;  
_timer/tools/iddb_ - файлы базы данных;  
_timer/tools/admin.config.php_ - файл конфигураций админпанели;  
_timer/tools/config.php_ - файл конфигураций таймера;  
_timer/tools/iddb.class.php_ - класс для работы с базой данных;  
_timer/tools/timer.class.php_ - класс для работы с таймером;  
_timer/admin.php_ - файл админпанели  
_timer/js_timer.php_ - файл генерации JavaScript-кода при установке таймера на страницу  
_timer/iframe_timer.php_ - файл генерации страницы с рабочим таймером  
_timer/index.php_ - индексный файл, используется в случае необходимости отображения разных страниц для активного/пассивного таймера (бекап)  
_timer/readme.html_ - файл документации  
_index.php_ - индексный файл, используется в случае необходимости отображения разных страниц для активного/пассивного таймера  
_demo.php_ - демострация работы таймера

### 2.2. Структура шаблонов
Раcсмотрим шаблон **default**:  

_timer/css_ - статические файлы скрипта, таблицы стилей, скрипты, изображения;  
_timer/css/style.css_ - шаблоны таймера;  
_timer/images_ - системные файлы;  
_timer/js_ - файлы базы данных;  
_timer/functions.js_ - файл конфигураций админпанели.  

HTML-верстка шаблона состоит из следующих элементов:  

_.countdown_block_ - временной блок (недели, дни, часы, минуты, секунды);  
_.digit_ - стиль цифры;  
_.separated_ - разделитель между временными блоками;  
_.countdown_block_title_ - заголовок временного блока.  

Код верстки блока:
`<div id="countdown_block_0" class="countdown_block" data-percent="100">
	<div class="countdown_block_title">недель</div>
	<div class="countdown_block_value">
		<span class="digit-group">
			<span class="digit">0</span>
			<span class="digit">1</span>
		</span>
	</div>
</div>`

## 3. Установка кода
### 3.1. Установка кода на сайт
Чтобы установить таймер/счетчик на сайте необходимо  

1. Cкачать, распаковать и загрузить папку timer в корень директории на странице которой будет расположен таймер, архив со скриптом таймера.  

2. Выставить права 777 на папки:  
_timer/tools_  
_timer/tools/iddb_  
_timer/tools/iddb/value_  

3. Выставить права 666 на файлы:  
_timer/tools/admin.config.php_  
_timer/tools/config.php_  
_timer/tools/iddb/table.php_  

4. Установить в необходимом месте, где должен отображаться таймер, код:

`<iframe id="timer_iframe" src="timer/iframe_timer.php"
	frameborder="0" style="width:100%;height:100%;"></iframe>`

5. Зайти в админ-панель, адрес http://пусть_к_вашей_папке/timer/admin.php (например, http://www.site.ru/timer/admin.php), и настроить таймер.

### 3.2. Установка таймера/счётчика с отображением разных страниц
**Внимание!** Данный метод не подходит для установки в корень сайта, если Ваш сайт работает на какой либо CMS (Wordpress, Joomla, DLE, Drupal и т.д.) и уже имеет в корневой папке файл index.php. Скрипт можно установить в какой подкаталог сайта.  
Чтобы установить таймер/счетчик на сайте необходимо:  

1. Cкачать, распаковать и загрузить папку timer и файл index.php в корень директории на странице которой будет расположен таймер, архив со скриптом таймера.  

2. Выставить права 777 на папки:  
_timer/tools_  
_timer/tools/iddb_  
_timer/tools/iddb/value_  

3. Выставить права 666 на файлы:  
_timer/tools/admin.config.php_  
_timer/tools/config.php_  
_timer/tools/iddb/table.php_  

4. Зайти в админ-панель, адрес http://пусть_к_вашей_папке/timer/admin.php (например, http://www.site.ru/timer/admin.php), и настроить таймер.

## 4. Работа с админ-панелью
### 4.1. Создание администратора
Если Вы впервые попали в админпанель таймера, ссылка http://пусть_к_вашей_папке/timer/admin.php (например, http://www.site.ru/timer/admin.php), то Вам будет предложено создать аккаунт администратора. Для этого необходимо указать желаемую пару логин/пароль и нажать кнопку "Создать". В дальнейшем, при входе, будет запрашиваться указанные Вами логин и пароль для авторизации.

## 4.2. Настройка времени
Когда Вы принялись за настройку времени, первым что требуется сделать - провести настройку времени. SD Timer поддерживает три типа таймера/счетчика, это  

**1. Отсчет к дате** - отсчет времени ведется к указанной конечной дате, больше всего подходит тем, у кого есть конечный срок выпуска продукции, окончание акции/конкурса.  

**2. Отсчет времени** - отсчет ведется непосредственно указанного времени, например, 1 день. Отсчет индивидуален для каждого посетителя, то есть время начинает отсчитывать с момента первого посещения страницы/сайта. В данном типе таймера существует настройка Cookie и IP, это необходимо для того, чтобы при последующих заходах на сайт, таймер отсчитывался не сначала, а с учетом первого посещения.  

**3. Специальный** - суть данного типа заключается в том, что отсчет времени ведется до указанного времени, дня недели либо числа месяца. Например, если Вам необходимо чтобы таймер постоянно отсчитывал время до 10 числа месяца, а 11 числа начинал отсчет сначала до следующего месяца, то этот тип специально для Вас.

## 4.3. Настройка страниц
Настройка страниц необходима в двух случаях:

1. Если необходимо, по завершению таймера, перенаправлять пользователя на другую страницу - для этого отмечаем галочкой соответствующий пункт и указываем страницу для редиректа.

2. Если необходимо отображаться разное содержимое страницы для активного таймера и оконченного - отмечаем соответствующий пункт и указываем ссылки на страницы с активным таймером (предварительно на нее устанавливаем таймер, пункт 3.1.) и без таймера, то есть страницу которая должна отображаться при выключенном таймере. Следует отметить, если данные страницы лежат в одной директории с файлом index.php таймера, пункт 3.2., то можно указать только их имена.

## 4.4. Настройка внешнего вида
Среди настроек внешнего вида существует выбор шаблона, выбор языка подписей (имеется ввиду подписей "недель", "дней", "часов", "минут", "секунд") и выбор соответствующих блоков для отображения.
